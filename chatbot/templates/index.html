<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>Chat Bot</title>
    {% load staticfiles %}

    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/message_bubble.css' %}"/>
    <script type="text/javascript" src="{% static 'js/js.cookie-2.2.0.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/action.js' %}"></script>
</head>
<body>

<div class="container">

    {% include 'nav.html' %}
    <div class="row">
        <div class="col-md-12">
            <ul class="nav nav-tabs nav-fill" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" role="tab" data-toggle="tab"
                       href="#chat" id="chat-tab" aria-controls="chat" aria-selected="true">对话系统</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" role="tab" data-toggle="tab"
                       href="#separation" id="separation-tab" aria-controls="separation">分词工具</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" role="tab" data-toggle="tab"
                       href="#synonym" id="synonym-tab" aria-controls="synonym">近义词判断</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" role="tab" data-toggle="tab"
                       href="#sentiment" id="sentiment-tab" aria-controls="sentiment">情感判断</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">&nbsp;</div>
        <div class="tab-content col-md-6" id="navContent">
            <!-- 聊天界面 -->
            <div class="tab-pane fade show active" id="chat" role="tabpanel" aria-labelledby="chat-tab">
                <!-- 对话列表 -->

                <div id="chat-box">
                    {% for item in history %}
                        {% if item.is_response %}
                            <div class="chat-item">
                                <div class="avatar2">
                                    <img src="{% static 'img/me.jpg' %}" class="avatar-img">
                                </div>
                                <div class="message2">
                                    {{ item.text|safe }}
                                </div>
                            </div>
                        {% else %}
                            <div class="chat-item">
                                <div class="avatar1">
                                    <img src="{{ current_user.avatar.avatar.url }}" class="avatar-img">
                                </div>
                                <div class="message1">
                                    {{ item.text }}
                                </div>
                            </div>

                        {% endif %}
                    {% endfor %}
                </div>
                <!-- 输入框 -->
                <div style="padding-top: 20px">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" placeholder="聊点什么吧" aria-label="Text"
                               aria-describedby="send" id="input-box">
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" type="button" id="send-button"
                                    onclick="sendMessage()">发送
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 分词 -->
            <div class="tab-pane fade" id="separation" role="tabpanel" aria-labelledby="separation-tab">
                <form>
                    <div class="form-group form">
                        <label for="to-separation">请输入句子</label>
                        <textarea class="form-control" id="to-separation" rows="3">翻译腔是指翻译出来的译文有洋化现象或不符合汉语习惯的表达方式。表现为译文不自然、不流畅、生硬、难懂、费解等特点。</textarea>
                    </div>
                    <button class="btn btn-primary" type="button" onclick="separation()">确定</button>
                </form>
            </div>
            <div class="tab-pane fade" id="synonym" role="tabpanel" aria-labelledby="synonym-tab">近义词</div>
            <div class="tab-pane fade" id="sentiment" role="tabpanel" aria-labelledby="sentiment-tab">
                <form>
                    <div class="form-group form">
                        <label for="to-sentiment">请输入句子</label>
                        <textarea class="form-control" id="to-sentiment" rows="3"></textarea>
                    </div>
                    <div>结果（数值越大表示句子积极程度越高）：</div>
                    <div id="sentiment-result"></div>
                    <button class="btn btn-primary" type="button" onclick="sentiment()">确定</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="response-template" style="display: none;">
    <div class="avatar2">
        <img src="{% static 'img/me.jpg' %}" class="avatar-img">
    </div>
</div>
<div id="say-template" style="display: none;">
    <div class="avatar1">
        {% if current_user.is_authenticated %}
        <img src="{{ current_user.avatar.avatar.url }}" class="avatar-img">
        {% else %}
        <img src="{% static 'img/default.png' %}" class="avatar-img">
        {% endif %}
    </div>
</div>
{% csrf_token %}
</body>

</html>